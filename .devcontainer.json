{
  "name": "cortex",
  // Pinned to 3.12 to match services/fastembed/Dockerfile (Phase 0: FastEmbed scaffold)
  "image": "mcr.microsoft.com/devcontainers/python:3.12",
  "features": {
    // Phase 0: "Verify remaining TypeScript compiles" — package.json requires node >=22.12.0
    "ghcr.io/devcontainers/features/node:1": {
      "version": "22"
    },
    // Phase 0 exit criteria: "docker compose up → gateway starts"
    "ghcr.io/devcontainers/features/docker-in-docker:2": {
      "version": "latest",
      "dockerDashComposeVersion": "v2"
    },
    // Pre-existing; not required by Phase 0 — left unchanged
    "ghcr.io/rio/features/chezmoi:1": {}
  },
  // Phase 0: package.json declares "packageManager": "pnpm@10.23.0";
  // corepack must be enabled for pnpm to resolve, then install deps.
  "postCreateCommand": "corepack enable && pnpm install",
  // Phase 0 exit criteria: allow testing gateway (18789) and fastembed (8000) from the devcontainer
  "forwardPorts": [18789, 8000]
}
